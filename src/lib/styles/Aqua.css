:root {
	--accent-color: #3471cf;
	--accent-color-inactive: #d4d4d4;
	--selection-color: #b5d5ff;
	--desktop-color: #daa15f;
	--pinstripe-bg-image: repeating-linear-gradient(
		to bottom,
		#ebecec,
		#ebecec 2px,
		#eff0f0 2px,
		#eff0f0 4px
	);
	--pulse-overlay-bg: radial-gradient(rgb(0 0 0 / 10%), transparent);
	--scrollbar-outline-color: #ababab;
	--scrollbar-size: 15px;
	--text-secondary: rgb(0 0 0 / 50%);
	--focus-box-shadow: 0 0 3px 2px #92b9db;
	--button-gradient: #f9f9f9, #ededed 40%, #dadada 40%, #ffffff;
	--button-active-gradient: #c8cceb, #7cb1e8 40%, #4895e3 40%, #82dcff;
	--button-border-gradient: #666666, #666666;
	--button-border-active-gradient: #272798, #616161;
	--widget-box-shadow: 0 2px 2px -1px #8b8b8b;
	--widget-sunken-box-shadow: 0 1px 1px #d4d4d4;
	--panel-box-shadow: 0 10px 15px 0 rgb(0 0 0 / 70%);
	--panel-box-shadow-inactive: 0 3px 5px 0 rgb(0 0 0 / 70%);
}

body {
	font-family: 'Lucida Grande', 'Lunasima', sans-serif;
}

#root {
	/* #region Menubar */
	.menubar {
		--menu-button-bg-image: linear-gradient(135deg, #3dadff, #1666ee);
		--menu-item-active-bg-image: linear-gradient(to bottom, #237ee9, #015cd8);
		--menu-option-active-bg-color: #336fcb;
		border-top: 1px solid #d9d9d9;
		border-bottom: 1px solid #bcbcbc;
		border-top-right-radius: 9px;
		border-top-left-radius: 9px;
		background-image: linear-gradient(to bottom, #ffffff, #f0f0f0 50%, #e8e8e8 50%, #ffffff);
	}

	.menuName {
		&:active,
		&:focus-visible,
		[open] & {
			@media (forced-colors: none) {
				background-image: var(--menu-item-active-bg-image);
			}
		}

		&::-webkit-details-marker {
			display: none;
		}
	}

	.menuLogo {
		background-image: linear-gradient(135deg, #3dadff, #1666ee);
		-webkit-background-clip: text;
		background-clip: text;
		color: transparent;

		.menuName:active &,
		.menuName:focus-visible &,
		[open] & {
			background-image: none;
			background-color: white;
			-webkit-background-clip: text;
			background-clip: text;
		}
	}

	.menuApp {
		font-weight: bold;
	}

	.menu {
		@media not (prefers-reduced-transparency: reduce) {
			&::before {
				opacity: 0.95;
			}
		}

		&::before {
			background-image: var(--pinstripe-bg-image);
		}
	}

	.menuItem:not(.disabled):is(:hover, :focus-within) {
		background-color: var(--menu-option-active-bg-color);
	}
	/* #endregion */

	/* #region Desktop */
	.desktop {
		background-image: url('$lib/images/wallpapers/beach.webp');
		background-position: 50% 25%;
	}
	/* #endregion */

	/* #region Window */
	.window {
		--window-radius: 12px;
		border: 1px solid rgb(0 0 0 / 33%);
		border-top-right-radius: var(--window-radius);
		border-top-left-radius: var(--window-radius);
		background-image: var(--pinstripe-bg-image);
	}

	.windowTitlebar {
		justify-content: space-between;
		border-radius: inherit;
		/* 1px line at bottom because border-bottom doesn't render right in Safari */
		background-image: linear-gradient(
			to bottom,
			#f9f9f9 1px,
			#efefef 1px,
			#cacaca calc(100% - 1px),
			#8c8c8c calc(100% - 1px)
		);

		.window.inactive & {
			background-image: linear-gradient(
				to bottom,
				transparent calc(100% - 1px),
				#8c8c8c calc(100% - 1px)
			);
			color: var(--text-secondary);
		}
	}

	.windowButton {
		box-shadow:
			inset 0 0 1px 1px rgb(0 0 0 / 50%),
			var(--widget-sunken-box-shadow);
		border: 1px solid transparent;
		border-radius: 9999px;
		background:
			/* top highlight */
			radial-gradient(ellipse 60% 30% at center top, white, rgb(255 255 255 / 80%), transparent)
				padding-box,
			/* bottom highlight */
				radial-gradient(ellipse 60% 70% at center bottom, white, white, transparent) padding-box,
			/* background color */
				linear-gradient(to bottom, var(--background-color), var(--background-color)) padding-box,
			/* border */ linear-gradient(to bottom, rgb(0 0 0 / 100%), rgb(0 0 0 / 50%)) border-box;
		background-blend-mode: normal, overlay, normal, normal;
		background-repeat: no-repeat;
		background-color: var(--background-color);
		padding: 0;
		width: 18px;
		height: 18px;

		@media (forced-colors: active) {
			&:enabled {
				border: 1px solid ButtonBorder;
			}
		}

		.window.inactive .windowControls:not(:hover, :focus-visible) &,
		.windowControls:not(:hover, :focus-visible) &:disabled {
			--background-color: #b5b5b5 !important;
			opacity: 0.5;
		}

		/* TODO remove .minimize when minimize is implemented */
		&:active:not(:disabled, .minimize) {
			filter: brightness(0.75);
		}

		&.close {
			--background-color: #c44a44;

			&.modified::after {
				position: absolute;
				border-radius: 50%;
				background-color: hsl(from var(--background-color) h s calc(l * 0.75));
				width: 8px;
				height: 8px;
				content: '';
			}
		}

		&.minimize {
			--background-color: #e89e28;
		}

		&.maximize {
			--background-color: #6aa71e;
		}
	}

	.windowButtonGlyph {
		--lightness: 0.9;
		transform: translateZ(0);
		visibility: hidden;
		mix-blend-mode: multiply;
		color: hsl(from var(--background-color) h s calc(l * var(--lightness)));
		stroke-width: 4;
		stroke-linecap: square;

		.windowButton.modified & {
			display: none;
		}

		.windowButton.minimize & {
			--lightness: 0.8;
		}

		.windowControls:is(:hover, :focus-visible, :has(.windowButton:active)) & {
			visibility: visible;
		}
	}

	/* brushed metal */
	.window.brushed {
		padding-inline: var(--titlebar-padding);
		padding-bottom: 32px;
		background: linear-gradient(
			to right,
			rgb(175 175 175),
			rgb(220 220 220) 40%,
			rgb(220 220 220) 60%,
			rgb(175 175 175)
		);
		--top-highlight-shadow: inset 0 2px 0px 0px rgb(217 217 217);
		box-shadow: var(--panel-box-shadow), var(--top-highlight-shadow);
		border-bottom-left-radius: var(--window-radius);
		border-bottom-right-radius: var(--window-radius);

		&::before {
			/* background on separate layer to control opacity */
			background: url('$lib/images/metal.webp');
			opacity: 50%;
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			content: '';
		}

		&.inactive {
			box-shadow: var(--panel-box-shadow-inactive), var(--top-highlight-shadow);
		}

		.windowTitlebar {
			padding-inline: 0;
			background: none;
		}

		.windowTitle {
			text-shadow: 0 1px 1px white;
		}

		.windowContent {
			> :not(.brushedInset, .brushedNoInset)::before {
				content: '⚠️ Use the .brushedInset class to render the inset border, or .brushedNoInset to hide this message ⚠️';
				font-size: 1rem;
			}
		}

		.windowResizeHandle {
			background: url('$lib/images/resize.webp');
			background-size: 20px 20px;
			background-position: center;
			background-repeat: no-repeat;
			bottom: 0;
			right: 0;
			width: 36px;
			height: 32px;
		}
	}

	.brushedInset:not(
		/* special case for nested containers (ex. AddressBook) */
		.brushedInset > .brushedInset
	) {
		border-top: 1px solid #737373;
		border-inline: 1px solid #999999;
		border-bottom: 1px solid #dfdfdf;
	}
	/* #endregion */

	/* #region Widgets */
	.aqua-button,
	.aqua-tab {
		height: 28px;
		min-width: 105px;
		display: flex;
		justify-content: center;
		align-items: center;
		padding-inline: 24px;
		box-shadow: var(--widget-box-shadow);
		border: 1px solid transparent;
		border-radius: 9999px;
		background:
			linear-gradient(to bottom, var(--button-gradient)) padding-box,
			linear-gradient(to bottom, var(--button-border-gradient)) border-box;
		color: black;
		font-size: 17px;
		text-align: center;
		white-space: nowrap;
		text-decoration: none;
		-webkit-user-select: none;
		user-select: none;

		&.square {
			border-radius: 5px;
		}

		&.icon {
			min-width: auto;
		}

		.window.brushed .windowToolbar & {
			box-shadow: var(--widget-sunken-box-shadow);
		}

		&:focus-visible {
			@media (forced-colors: none) {
				--button-border-gradient: #6f89a0, #6f89a0;
				outline: none;
				box-shadow: var(--focus-box-shadow);
			}
		}

		&:is(.aqua-button:is(:active, .active), .aqua-tab:is(:has(input:checked), .active)):not(
				:disabled,
				.disabled
			) {
			--button-gradient: var(--button-active-gradient);
			--button-border-gradient: var(--button-border-active-gradient);
		}

		&.primary:not(.window.inactive .primary) {
			--button-gradient: var(--button-active-gradient);
			--button-border-gradient: var(--button-border-active-gradient);

			&:not(:active) {
				animation: 0.5s linear infinite alternate pulsate;
			}
		}

		svg {
			opacity: 0.75;
		}
		&:is(:disabled, .disabled) svg {
			opacity: 0.33;
		}

		@media not (scripting: none) {
			cursor: default;
		}
	}

	.aqua-tab {
		box-shadow: none;

		&:has(+ &) {
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
		}

		& + & {
			border-top-left-radius: 0;
			border-bottom-left-radius: 0;
			border-left-width: 0;
		}

		&:not(:has(input:checked), .active):active {
			filter: brightness(0.9);
		}
	}
	/* #endregion */
}

/* #region Scrollbar */
:not(.aqua-no-scrollbar)::-webkit-scrollbar {
	outline: 1px solid var(--scrollbar-outline-color);
	width: var(--scrollbar-size);
	height: var(--scrollbar-size);
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-track {
	--track-dir: right;
	--track-gradient:
		#b8b8b8, #c0c0c0, #c8c8c8, #d3d3d3, #dbdbdb, #e4e4e4, #ebebeb, #ebebeb, #f1f1f1, #f6f6f6,
		#fafafa, #fbfbfb, #fcfcfc, #f9f9f9, #f4f4f4, #efefef;
	background-image: linear-gradient(to var(--track-dir), var(--track-gradient));
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-track:horizontal {
	--track-dir: bottom;
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-thumb {
	--border-color: #0139b3;
	--cap-dir: bottom;
	--cap-gradient: #0139b3bd, transparent 7.5px, transparent calc(100% - 7.5px), #0139b3bd;
	--scrollbar-dir: right;
	--scrollbar-gradient:
		#0139b3, #75a7e0, #96bfe9, #95bde9, #8ebbeb, #579be7, #6cabf3, #7cbbff, #8eccff, #9adaff,
		#a8ebfe, #9fe0ff, #5c5c5c;
	border: 1px solid var(--border-color);
	border-radius: 9999px;
	background:
		linear-gradient(to var(--cap-dir), var(--cap-gradient)),
		var(--pulse-overlay-bg) 0% 0% / var(--scrollbar-size) var(--scrollbar-size) fixed,
		linear-gradient(to var(--scrollbar-dir), var(--scrollbar-gradient));
	background-blend-mode: multiply, normal, normal;
}

@media (forced-colors: active) {
	:not(.aqua-no-scrollbar)::-webkit-scrollbar-thumb {
		background-color: CanvasText !important;
	}
}

.window.inactive :not(.aqua-no-scrollbar)::-webkit-scrollbar-thumb {
	--border-color: #8b8b8b;
	--cap-gradient:
		rgb(0 0 0 / 25%), transparent 7.5px, transparent calc(100% - 7.5px), rgb(0 0 0 / 25%);
	background-image:
		linear-gradient(to var(--cap-dir), var(--cap-gradient)),
		linear-gradient(to var(--scrollbar-dir), var(--button-gradient));
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-thumb:horizontal {
	--cap-dir: right;
	--scrollbar-dir: bottom;
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button {
	--button-dir: bottom;
	--border-color: #969696;
	--arrow-bg: 		/* left */ url('data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjciIHZpZXdCb3g9IjAgMCA2IDciIHdpZHRoPSI2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im0wIDMuNSA2IDMuNXYtN3oiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==');
	display: block;
	border-left: 1px solid var(--border-color);
	background:
		var(--arrow-bg) center no-repeat,
		linear-gradient(to var(--button-dir), var(--button-gradient));
	width: var(--scrollbar-size);
	height: var(--scrollbar-size);
}

@media (forced-colors: active) {
	:not(.aqua-no-scrollbar)::-webkit-scrollbar-button {
		background:
			var(--arrow-bg) center no-repeat,
			linear-gradient(to var(--button-dir), white, white) !important;
	}
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button:active {
	--button-gradient:
		#1c6bc8, #5252b6, #97a2dc, #a3bae6, #a4c7eb, #afceee, #a4c6eb, #4287d3, #5090d6, #5896da,
		#629ee0, #6eacec, #80c1ff, #83caff, #6dc3ff;
	--border-color: #2068c6;
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button:increment {
	--arrow-bg: 		/* right */ url('data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjciIHZpZXdCb3g9IjAgMCA2IDciIHdpZHRoPSI2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im02IDMuNS02IDMuNXYtN3oiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==');
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button:vertical {
	--button-dir: right;
	--arrow-bg: 		/* up */ url('data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjYiIHZpZXdCb3g9IjAgMCA3IDYiIHdpZHRoPSI3IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im0zLjUgMCAzLjUgNmgtN3oiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==');
	border-top: 1px solid var(--border-color);
	border-left: none;
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button:vertical:increment {
	--arrow-bg: 		/* down */ url('data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjYiIHZpZXdCb3g9IjAgMCA3IDYiIHdpZHRoPSI3IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im0zLjUgNiAzLjUtNmgtN3oiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==');
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-button:start {
	display: none;
}

:not(.aqua-no-scrollbar)::-webkit-scrollbar-corner {
	outline: 1px solid var(--scrollbar-outline-color);
	background-color: white;
}
/* #endregion */

/* #region Declarations */
@keyframes pulsate {
	from {
		filter: brightness(1.1) saturate(1);
	}
	to {
		filter: brightness(1) saturate(0.9);
	}
}

@font-face {
	src:
		local('Lucida Grande'),
		local('Lunasima'),
		url('$lib/fonts/Lunasima-Regular.ttf') format('truetype');
	font-family: 'Lunasima';
}

@font-face {
	font-weight: bold;
	src:
		local('Lucida Grande'),
		local('Lunasima'),
		url('$lib/fonts/Lunasima-Bold.ttf') format('truetype');
	font-family: 'Lunasima';
}
/* #endregion */
